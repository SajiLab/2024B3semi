# B3プログラミングゼミ 第1回
今回実施する内容は以下の通りです。

- BMP ファイルの読み込み、書き出しの実装
- カラー画像とグレースケール画像の相互変換

実装の際は以下のようなことを考えてみてください。(ひょっとしたら考察のネタになるかも...)

- BMP ファイルはどのような構造になっているか (\[[1]\]や\[[2]\]のサイトを参考にどうぞ．)
- 画像サイズはどのように計算されているか
- 画素値の最低値、最大値はいくつか、またなぜその値なのか
- 画素の座標(x,y) = (0,0)は画像のどの位置にあるか


[1]: https://algorithm.joho.info/image-processing/bmp-file-data-header/
[2]: https://qiita.com/spc_ehara/items/03d179f4901faeadb184

## 取り扱う画像について

第1回目のゼミでは画像処理技術ではなく、データとしての画像そのものについて触れておきましょう。

### ビットマップ画像(.bmp)


本ゼミで使用する画像はbmp(ビットマップ)形式と呼ばれるものです。画像を画素(pixel)と呼ばれる格子状に分割しており、その1つ1つが画素値と呼ばれる情報を持っています。一般的に画像の拡張子として知られている.jpgや.pngとは違い、**データを圧縮していない非圧縮データ**であることが最大の特徴です。その分、ファイルサイズも大きいことには注意しましょう。

### カラー画像
パターン認識の講義とは違い、今後の研究ではカラー画像を使用しての画像処理となります。

カラー画像は画素1ピクセルの色をR(赤)、G(緑)、B(青)の3原色で表現します。1画素のRGB要素を8ビットで表す24ビット画像が一般的です。

それぞれのチャンネルの画素値を抜き出した3つの画像を図1に示します。なぜ色がなくグレーであるのかは次の項でわかると思います。


<div>
<div style="text-align: center;">
<img src="semi_img/1_rgb_lenna.png">

図1 左からRチャンネル、Gチャンネル、Bチャンネル
</div>



### グレースケール画像

RGBカラー画像に対し、白黒の濃淡を表現した画像がグレースケール画像です。グレースケール画像は1画素を8ビットで表すため、色情報を持たず、明るさ情報のみを保持しています。画素値が0に近いほど画素は暗くなり、255に近いほど明るくなっていきます。図1がグレーだったのは，24ビットの画像を3つに分解し，各チャンネルを8ビット画像として表わしているからです．

カラー画像をグレースケール画像に変換したのが図2です．

<div>
<div style="text-align: center;">
<img src="semi_img/1_gray_lenna.png" width="300"> <br>
図2 グレースケール画像
</div>


図1で示した画像群の平均値を取った画像が図2となっています．24ビット画像を8ビット画像に圧縮した，という表現の方がわかりやすいでしょうか．


## 実装課題

1. bmpファイルの入出力処理を実装し，入出力が適切に行われることを確認してください．

2. カラー画像をグレースケール画像に変換する処理を実装してください．

3. 指定された画像2枚をそれぞれグレースケール画像に変換してください．1枚はグレースケールに変換できますが，もう1枚は変換がうまくいきません．なぜそのような違いが出るのか考察，および調査し，レポートに記述してください．

処理を実装するファイルは以下の通りです。

- `imagemat.py`：ヘッダファイル
   - クラスの定義
   - 関数のプロトタイプ宣言
- `fileio.py`：BMP 画像の入出力を行うソースファイル
- `color_convert.py`：グレースケール化の処理を行うソースファイル
- `main.py`：`main`関数が記述されているソースファイル



## 実装について

基本的には、皆さんに提供したファイルのうち、`.py`ファイルに追加・変更を行ってプログラムの実装を行なってもらいます。

プログラム中の変数や関数の定義については各ファイルにコメントの形で記述してありますので、必ず確認しながら実装を行ってください。

なお、実装においてわからないことがあれば SlackのB3ゼミ用チャンネル`b3ゼミ2024`で質問をお願いします。

### 実装時のポイント

- 空欄を適切に埋めれば動作するようになっていますが、想定通りの動作が保証される範囲内でいくらでも改造を施して構いません。

- 作成したファイル名を`main.py`内の最初にimportしてください。

- Visual Studio Codeの拡張機能である`Hex Editor`\[[3]\]は、bmpファイルのヘッダ情報を数値で直接確認することができます。考察のために必要ならば使ってみてください。

[3]: https://marketplace.visualstudio.com/items?itemName=ms-vscode.hexeditor 

